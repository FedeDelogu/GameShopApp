@using WebAppPlayshphere.DAO
@model Dictionary<WebAppPlayshphere.Models.Utente, List<WebAppPlayshphere.Models.Recensione>>
@{
    Layout = "_LayoutProfilo";
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/Profilo/recensioni.css">
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/css/Layout/mainLayout.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/WebAppPlayshphere.styles.css" asp-append-version="true" />
    <title>Le tue Recensioni</title>
</head>
<body class="vh-100">


    <!-- Sezione recensioni -->
    <section class="container py-4 px-5 rounded-bottom-5 overflow-auto" id="recensioni">
        <h3 class="text-center py-2 fs-1" style="color: var(--floral-white);">LE TUE RECENSIONI</h3>

        @foreach (var kvp in Model)
        {
            <h5 class="text-center py-4">
                Benvenuto <span class="fw-bold" style="color:var(--flame)">@kvp.Key.Username</span>!
            </h5>

            @if (kvp.Value != null && kvp.Value.Any())
            {
                <div class="row gy-3">
                    @foreach (var recensione in kvp.Value)
                    {
                        
                        var daoVideogioco = DAOVideogioco.GetIstance();
                        var titoloVideogioco = daoVideogioco.FindTitolo(recensione.IdVideogioco);
                        

                        <div class="col-md-4">
                            <div class="card rounded-4 text-white bg-dark h-100">
                                <div class="card-body">
                                    <h5 class="fw-bold" style="color:var(--flame)">@titoloVideogioco</h5>
                                    

                                    <p class="card-text">
                                        @recensione.Commento
                                    </p>

                                    <!-- Stelline per la valutazione -->
                                    <div>
                                        @for (double i = 0; i < 5; i++)
                                        {
                                            var rating = recensione.Valutazione;  // Assicurati che recensione.Valutazione sia un tipo numerico (double o float)

                                            if (i < (int)rating)  // Se l'indice è inferiore al valore intero della valutazione
                                            {
                                                <span class="bi bi-star-fill" style="color:gold;"></span> <!-- Stella piena -->
                                            }
                                            else if (i < (int)rating + 1 && rating - (int)rating >= 0.5)  // Se la parte decimale è >= 0.5, mostra una mezza stella
                                            {
                                                <span class="bi bi-star-half" style="color:gold;"></span> <!-- Mezza stella -->
                                            }
                                            else
                                            {
                                                <span class="bi bi-star" style="color:gold;"></span> <!-- Stella vuota -->
                                            }
                                        }
                                        <span class="ms-2">@recensione.Valutazione.ToString("F1")</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    }
                </div>
            }
            else
            {
                <p class="text-center mt-3">Non hai ancora lasciato recensioni.</p>
            }
        }

    </section>

    <!-- Inclusione di Bootstrap e icone per le stelle -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://kit.fontawesome.com/a076d05399.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">

</body>
</html>
